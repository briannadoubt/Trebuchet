# trebuche.yaml - Fly.io Deployment Example
#
# Deploy with: trebuche deploy --provider fly

name: trebuche-demo
version: "1"

defaults:
  provider: fly         # Use Fly.io instead of AWS
  region: ord           # Chicago (use your nearest region)
  memory: 512           # MB per instance
  timeout: 30           # seconds

actors:
  # Simple stateless actor
  GameLobby:
    memory: 256

  # Stateful actor with persistent state
  GameRoom:
    memory: 512
    stateful: true

  # Heavy computation actor
  GameEngine:
    memory: 1024

# State configuration
state:
  type: postgresql      # Use PostgreSQL for state (automatically provisioned on Fly.io)

# Optional: Observability (works the same on Fly.io or AWS)
observability:
  logging:
    level: info
    format: json

  metrics:
    enabled: true
    collector: inmemory  # Use in-memory collector (logs to console)

# Optional: Security (works the same on Fly.io or AWS)
security:
  authentication:
    type: apikey
    keys:
      - name: "client-app"
        key: "sk-demo-12345"

  rateLimiting:
    requestsPerSecond: 100
    burstSize: 200

# Deployment regions (Fly.io supports multi-region easily)
# Uncomment to deploy to multiple regions:
# regions:
#   - ord  # Chicago
#   - lax  # Los Angeles
#   - fra  # Frankfurt
